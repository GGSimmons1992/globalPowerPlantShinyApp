---
title: "R Notebook"
output: html_notebook
---
data load
```{r}
library(dplyr)
library(data.table)
library(ggplot2)
powerplants=read.csv('global_power_plant_database.csv')
powerplants[is.na(powerplants)] = 0
powerplantsAfghanistan = powerplants %>% filter(country_long == "Afghanistan")
```
Data prep
```{r}
powerplantsAfghanistanFuel = powerplantsAfghanistan %>% group_by(primary_fuel) 

powerplantsAfghanistanFuelYear = powerplantsAfghanistanFuel %>% summarise(energy2013 = 0.5* (sum(generation_gwh_2013) + sum(estimated_generation_gwh_2013)),
          energy2014 = 0.5* (sum(generation_gwh_2014) + sum(estimated_generation_gwh_2014)),
          energy2015 = 0.5* (sum(generation_gwh_2015) + sum(estimated_generation_gwh_2015)),
          energy2016 = 0.5* (sum(generation_gwh_2016) + sum(estimated_generation_gwh_2016)),
          energy2017 = 0.5* (sum(generation_gwh_2017) + sum(estimated_generation_gwh_2017)),
          )

totalEnergy = powerplantsAfghanistanFuelYear %>% mutate(total = energy2013+ energy2014 +energy2015 + energy2016 + energy2017)

transposePowerplantsAfghanistanFuelYear = transpose(powerplantsAfghanistanFuelYear)
transposePowerplantsAfghanistanFuelYear$V4 = c("Year",2013,2014,2015,2016,2017,)
names(transposePowerplantsAfghanistanFuelYear) = transposePowerplantsAfghanistanFuelYear[1,]
```

map
```{r}

```

pie chart
```{r}
ggplot(totalEnergy,aes(x="",y=total,fill=primary_fuel)) + geom_bar(width=1,stat="identity") + coord_polar("y",start=0) + scale_fill_manual(values=c("green","blue","red"))
```

energy produced
```{r}

preplotdf=transposePowerplantsAfghanistanFuelYear[-1,]
ggplot(preplotdf, aes(x=Year,group=1)) + geom_line(aes(y = Gas),color="green") + geom_line(aes(y=Hydro),color="blue") + geom_line(aes(y=Solar),color="red") + ylab("Energy Produce MWH")

```

number of plants by type
```{r}
numberOfPlants = powerplantsAfghanistanFuel %>% summarize(number = n())
ggplot(numberOfPlants,aes(x="",y=number,fill=primary_fuel)) + geom_bar(width=1,stat="identity") + coord_polar("y",start=0) + scale_fill_manual(values=c("green","blue","red"))
```